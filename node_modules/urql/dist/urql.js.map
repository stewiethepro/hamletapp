{"version":3,"file":"urql.js","sources":["../src/context.ts","../src/hooks/state.ts","../src/hooks/useMutation.ts","../src/hooks/useRequest.ts","../src/hooks/cache.ts","../src/hooks/useQuery.ts","../src/hooks/useSubscription.ts","../src/components/Mutation.ts","../src/components/Query.ts","../src/components/Subscription.ts"],"sourcesContent":["import { createContext, useContext } from 'react';\nimport { Client, createClient } from '@urql/core';\n\n// We assume some default options here; mainly not to actually be used\n// but not to error catastrophically if someone is just playing around\nconst defaultClient = createClient({ url: '/graphql' });\n\nexport const Context = createContext<Client>(defaultClient);\nexport const Provider = Context.Provider;\nexport const Consumer = Context.Consumer;\nContext.displayName = 'UrqlContext';\n\nlet hasWarnedAboutDefault = false;\n\nexport const useClient = (): Client => {\n  const client = useContext(Context);\n\n  if (\n    process.env.NODE_ENV !== 'production' &&\n    client === defaultClient &&\n    !hasWarnedAboutDefault\n  ) {\n    hasWarnedAboutDefault = true;\n\n    console.warn(\n      \"Default Client: No client has been specified using urql's Provider.\" +\n        'This means that urql will be falling back to defaults including making ' +\n        'requests to `/graphql`.\\n' +\n        \"If that's not what you want, please create a client and add a Provider.\"\n    );\n  }\n\n  return client;\n};\n","export const initialState = {\n  fetching: false,\n  stale: false,\n  error: undefined,\n  data: undefined,\n  extensions: undefined,\n  operation: undefined,\n};\n\nconst isShallowDifferent = (a: any, b: any) => {\n  if (typeof a != 'object' || typeof b != 'object') return a !== b;\n  for (const x in a) if (!(x in b)) return true;\n  for (const x in b) if (a[x] !== b[x]) return true;\n  return false;\n};\n\ninterface Stateish {\n  data?: any;\n  error?: any;\n  fetching: boolean;\n  stale: boolean;\n}\n\nexport const computeNextState = <T extends Stateish>(\n  prevState: T,\n  result: Partial<T>\n): T => {\n  const newState = {\n    ...prevState,\n    ...result,\n    data:\n      result.data !== undefined || result.error ? result.data : prevState.data,\n    fetching: !!result.fetching,\n    stale: !!result.stale,\n  };\n\n  return isShallowDifferent(prevState, newState) ? newState : prevState;\n};\n\nexport const hasDepsChanged = <T extends { length: number }>(a: T, b: T) => {\n  for (let i = 0, l = b.length; i < l; i++) if (a[i] !== b[i]) return true;\n  return false;\n};\n","import { DocumentNode } from 'graphql';\nimport { useState, useCallback, useRef, useEffect } from 'react';\nimport { pipe, toPromise } from 'wonka';\n\nimport {\n  TypedDocumentNode,\n  OperationResult,\n  OperationContext,\n  CombinedError,\n  createRequest,\n  Operation,\n} from '@urql/core';\n\nimport { useClient } from '../context';\nimport { initialState } from './state';\n\nexport interface UseMutationState<Data = any, Variables = object> {\n  fetching: boolean;\n  stale: boolean;\n  data?: Data;\n  error?: CombinedError;\n  extensions?: Record<string, any>;\n  operation?: Operation<Data, Variables>;\n}\n\nexport type UseMutationResponse<Data = any, Variables = object> = [\n  UseMutationState<Data, Variables>,\n  (\n    variables?: Variables,\n    context?: Partial<OperationContext>\n  ) => Promise<OperationResult<Data, Variables>>\n];\n\nexport function useMutation<Data = any, Variables = object>(\n  query: DocumentNode | TypedDocumentNode<Data, Variables> | string\n): UseMutationResponse<Data, Variables> {\n  const isMounted = useRef(true);\n  const client = useClient();\n\n  const [state, setState] = useState<UseMutationState<Data, Variables>>(\n    initialState\n  );\n\n  const executeMutation = useCallback(\n    (variables?: Variables, context?: Partial<OperationContext>) => {\n      setState({ ...initialState, fetching: true });\n\n      return pipe(\n        client.executeMutation<Data, Variables>(\n          createRequest<Data, Variables>(query, variables),\n          context || {}\n        ),\n        toPromise\n      ).then(result => {\n        if (isMounted.current) {\n          setState({\n            fetching: false,\n            stale: !!result.stale,\n            data: result.data,\n            error: result.error,\n            extensions: result.extensions,\n            operation: result.operation,\n          });\n        }\n        return result;\n      });\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [client, query, setState]\n  );\n\n  useEffect(() => {\n    isMounted.current = true;\n    return () => {\n      isMounted.current = false;\n    };\n  }, []);\n\n  return [state, executeMutation];\n}\n","import { DocumentNode } from 'graphql';\nimport { useRef, useMemo } from 'react';\nimport { TypedDocumentNode, GraphQLRequest, createRequest } from '@urql/core';\n\n/** Creates a request from a query and variables but preserves reference equality if the key isn't changing */\nexport function useRequest<Data = any, Variables = object>(\n  query: string | DocumentNode | TypedDocumentNode<Data, Variables>,\n  variables?: Variables\n): GraphQLRequest<Data, Variables> {\n  const prev = useRef<undefined | GraphQLRequest<Data, Variables>>(undefined);\n\n  return useMemo(() => {\n    const request = createRequest<Data, Variables>(query, variables);\n    // We manually ensure reference equality if the key hasn't changed\n    if (prev.current !== undefined && prev.current.key === request.key) {\n      return prev.current;\n    } else {\n      prev.current = request;\n      return request;\n    }\n  }, [query, variables]);\n}\n","import { pipe, subscribe } from 'wonka';\nimport { Client, OperationResult } from '@urql/core';\n\ntype CacheEntry = OperationResult | Promise<unknown> | undefined;\n\ninterface Cache {\n  get(key: number): CacheEntry;\n  set(key: number, value: CacheEntry): void;\n  dispose(key: number): void;\n}\n\ninterface ClientWithCache extends Client {\n  _react?: Cache;\n}\n\nexport const getCacheForClient = (client: Client): Cache => {\n  if (!(client as ClientWithCache)._react) {\n    const reclaim = new Set();\n    const map = new Map<number, CacheEntry>();\n\n    if (client.operations$ /* not available in mocks */) {\n      pipe(\n        client.operations$,\n        subscribe(operation => {\n          if (operation.kind === 'teardown' && reclaim.has(operation.key)) {\n            reclaim.delete(operation.key);\n            map.delete(operation.key);\n          }\n        })\n      );\n    }\n\n    (client as ClientWithCache)._react = {\n      get(key) {\n        return map.get(key);\n      },\n      set(key, value) {\n        reclaim.delete(key);\n        map.set(key, value);\n      },\n      dispose(key) {\n        reclaim.add(key);\n      },\n    };\n  }\n\n  return (client as ClientWithCache)._react!;\n};\n","/* eslint-disable react-hooks/exhaustive-deps */\n\nimport { DocumentNode } from 'graphql';\nimport { Source, pipe, subscribe, onEnd, onPush, takeWhile } from 'wonka';\nimport { useState, useEffect, useCallback, useMemo } from 'react';\n\nimport {\n  Client,\n  TypedDocumentNode,\n  CombinedError,\n  OperationContext,\n  RequestPolicy,\n  OperationResult,\n  Operation,\n} from '@urql/core';\n\nimport { useClient } from '../context';\nimport { useRequest } from './useRequest';\nimport { getCacheForClient } from './cache';\nimport { initialState, computeNextState, hasDepsChanged } from './state';\n\nexport interface UseQueryArgs<Variables = object, Data = any> {\n  query: string | DocumentNode | TypedDocumentNode<Data, Variables>;\n  variables?: Variables;\n  requestPolicy?: RequestPolicy;\n  context?: Partial<OperationContext>;\n  pause?: boolean;\n}\n\nexport interface UseQueryState<Data = any, Variables = object> {\n  fetching: boolean;\n  stale: boolean;\n  data?: Data;\n  error?: CombinedError;\n  extensions?: Record<string, any>;\n  operation?: Operation<Data, Variables>;\n}\n\nexport type UseQueryResponse<Data = any, Variables = object> = [\n  UseQueryState<Data, Variables>,\n  (opts?: Partial<OperationContext>) => void\n];\n\nconst isSuspense = (client: Client, context?: Partial<OperationContext>) =>\n  client.suspense && (!context || context.suspense !== false);\n\nexport function useQuery<Data = any, Variables = object>(\n  args: UseQueryArgs<Variables, Data>\n): UseQueryResponse<Data, Variables> {\n  const client = useClient();\n  const cache = getCacheForClient(client);\n  const suspense = isSuspense(client, args.context);\n  const request = useRequest<Data, Variables>(args.query, args.variables);\n\n  const source = useMemo(() => {\n    if (args.pause) return null;\n\n    const source = client.executeQuery(request, {\n      requestPolicy: args.requestPolicy,\n      ...args.context,\n    });\n\n    return suspense\n      ? pipe(\n          source,\n          onPush(result => {\n            cache.set(request.key, result);\n          })\n        )\n      : source;\n  }, [\n    cache,\n    client,\n    request,\n    suspense,\n    args.pause,\n    args.requestPolicy,\n    args.context,\n  ]);\n\n  const getSnapshot = useCallback(\n    (\n      source: Source<OperationResult<Data, Variables>> | null,\n      suspense: boolean\n    ): Partial<UseQueryState<Data, Variables>> => {\n      if (!source) return { fetching: false };\n\n      let result = cache.get(request.key);\n      if (!result) {\n        let resolve: (value: unknown) => void;\n\n        const subscription = pipe(\n          source,\n          takeWhile(() => (suspense && !resolve) || !result),\n          subscribe(_result => {\n            result = _result;\n            if (resolve) resolve(result);\n          })\n        );\n\n        if (result == null && suspense) {\n          const promise = new Promise(_resolve => {\n            resolve = _resolve;\n          });\n\n          cache.set(request.key, promise);\n          throw promise;\n        } else {\n          subscription.unsubscribe();\n        }\n      } else if (suspense && result != null && 'then' in result) {\n        throw result;\n      }\n\n      return (result as OperationResult<Data, Variables>) || { fetching: true };\n    },\n    [cache, request]\n  );\n\n  const deps = [\n    client,\n    request,\n    args.requestPolicy,\n    args.context,\n    args.pause,\n  ] as const;\n\n  const [state, setState] = useState(\n    () =>\n      [\n        source,\n        computeNextState(initialState, getSnapshot(source, suspense)),\n        deps,\n      ] as const\n  );\n\n  let currentResult = state[1];\n  if (source !== state[0] && hasDepsChanged(state[2], deps)) {\n    setState([\n      source,\n      (currentResult = computeNextState(\n        state[1],\n        getSnapshot(source, suspense)\n      )),\n      deps,\n    ]);\n  }\n\n  useEffect(() => {\n    const source = state[0];\n    const request = state[2][1];\n\n    let hasResult = false;\n\n    const updateResult = (result: Partial<UseQueryState<Data, Variables>>) => {\n      hasResult = true;\n      setState(state => {\n        const nextResult = computeNextState(state[1], result);\n        return state[1] !== nextResult\n          ? [state[0], nextResult, state[2]]\n          : state;\n      });\n    };\n\n    if (source) {\n      const subscription = pipe(\n        source,\n        onEnd(() => {\n          updateResult({ fetching: false });\n        }),\n        subscribe(updateResult)\n      );\n\n      if (!hasResult) updateResult({ fetching: true });\n\n      return () => {\n        cache.dispose(request.key);\n        subscription.unsubscribe();\n      };\n    } else {\n      updateResult({ fetching: false });\n    }\n  }, [cache, state[0], state[2][1]]);\n\n  const executeQuery = useCallback(\n    (opts?: Partial<OperationContext>) => {\n      const context = {\n        requestPolicy: args.requestPolicy,\n        ...args.context,\n        ...opts,\n      };\n\n      setState(state => {\n        const source = suspense\n          ? pipe(\n              client.executeQuery(request, context),\n              onPush(result => {\n                cache.set(request.key, result);\n              })\n            )\n          : client.executeQuery(request, context);\n        return [source, state[1], deps];\n      });\n    },\n    [\n      client,\n      cache,\n      request,\n      suspense,\n      getSnapshot,\n      args.requestPolicy,\n      args.context,\n    ]\n  );\n\n  return [currentResult, executeQuery];\n}\n","/* eslint-disable react-hooks/exhaustive-deps */\n\nimport { DocumentNode } from 'graphql';\nimport { pipe, subscribe, onEnd } from 'wonka';\nimport { useEffect, useState, useCallback, useMemo, useRef } from 'react';\n\nimport {\n  TypedDocumentNode,\n  CombinedError,\n  OperationContext,\n  Operation,\n} from '@urql/core';\n\nimport { useClient } from '../context';\nimport { useRequest } from './useRequest';\nimport { initialState, computeNextState, hasDepsChanged } from './state';\n\nexport interface UseSubscriptionArgs<Variables = object, Data = any> {\n  query: DocumentNode | TypedDocumentNode<Data, Variables> | string;\n  variables?: Variables;\n  pause?: boolean;\n  context?: Partial<OperationContext>;\n}\n\nexport type SubscriptionHandler<T, R> = (prev: R | undefined, data: T) => R;\n\nexport interface UseSubscriptionState<Data = any, Variables = object> {\n  fetching: boolean;\n  stale: boolean;\n  data?: Data;\n  error?: CombinedError;\n  extensions?: Record<string, any>;\n  operation?: Operation<Data, Variables>;\n}\n\nexport type UseSubscriptionResponse<Data = any, Variables = object> = [\n  UseSubscriptionState<Data, Variables>,\n  (opts?: Partial<OperationContext>) => void\n];\n\nexport function useSubscription<Data = any, Result = Data, Variables = object>(\n  args: UseSubscriptionArgs<Variables, Data>,\n  handler?: SubscriptionHandler<Data, Result>\n): UseSubscriptionResponse<Result, Variables> {\n  const client = useClient();\n  const request = useRequest<Data, Variables>(args.query, args.variables);\n\n  const handlerRef = useRef<SubscriptionHandler<Data, Result> | undefined>(\n    handler\n  );\n  handlerRef.current = handler;\n\n  const source = useMemo(\n    () =>\n      !args.pause ? client.executeSubscription(request, args.context) : null,\n    [client, request, args.pause, args.context]\n  );\n\n  const deps = [client, request, args.context, args.pause] as const;\n\n  const [state, setState] = useState(\n    () => [source, { ...initialState, fetching: !!source }, deps] as const\n  );\n\n  let currentResult = state[1];\n  if (source !== state[0] && hasDepsChanged(state[2], deps)) {\n    setState([\n      source,\n      (currentResult = computeNextState(state[1], { fetching: !!source })),\n      deps,\n    ]);\n  }\n\n  useEffect(() => {\n    const updateResult = (\n      result: Partial<UseSubscriptionState<Data, Variables>>\n    ) => {\n      setState(state => {\n        const nextResult = computeNextState(state[1], result);\n        if (state[1] === nextResult) return state;\n        if (handlerRef.current && state[1].data !== nextResult.data) {\n          nextResult.data = handlerRef.current(\n            state[1].data,\n            nextResult.data!\n          ) as any;\n        }\n\n        return [state[0], nextResult as any, state[2]];\n      });\n    };\n\n    if (state[0]) {\n      return pipe(\n        state[0],\n        onEnd(() => {\n          updateResult({ fetching: false });\n        }),\n        subscribe(updateResult)\n      ).unsubscribe;\n    } else {\n      updateResult({ fetching: false });\n    }\n  }, [state[0]]);\n\n  // This is the imperative execute function passed to the user\n  const executeSubscription = useCallback(\n    (opts?: Partial<OperationContext>) => {\n      const source = client.executeSubscription(request, {\n        ...args.context,\n        ...opts,\n      });\n\n      setState(state => [source, state[1], deps]);\n    },\n    [client, args.context, request]\n  );\n\n  return [currentResult, executeSubscription];\n}\n","import { DocumentNode } from 'graphql';\nimport { ReactElement } from 'react';\nimport {\n  TypedDocumentNode,\n  OperationResult,\n  OperationContext,\n} from '@urql/core';\nimport { useMutation, UseMutationState } from '../hooks';\n\nexport interface MutationProps<Data = any, Variables = object> {\n  query: DocumentNode | TypedDocumentNode<Data, Variables> | string;\n  children: (arg: MutationState<Data, Variables>) => ReactElement<any>;\n}\n\nexport interface MutationState<Data = any, Variables = object>\n  extends UseMutationState<Data, Variables> {\n  executeMutation: (\n    variables?: Variables,\n    context?: Partial<OperationContext>\n  ) => Promise<OperationResult<Data, Variables>>;\n}\n\nexport function Mutation<Data = any, Variables = any>(\n  props: MutationProps<Data, Variables>\n): ReactElement<any> {\n  const mutation = useMutation<Data, Variables>(props.query);\n  return props.children({ ...mutation[0], executeMutation: mutation[1] });\n}\n","import { ReactElement } from 'react';\nimport { OperationContext } from '@urql/core';\nimport { useQuery, UseQueryArgs, UseQueryState } from '../hooks';\n\nexport interface QueryProps<Data = any, Variables = object>\n  extends UseQueryArgs<Variables, Data> {\n  children: (arg: QueryState<Data, Variables>) => ReactElement<any>;\n}\n\nexport interface QueryState<Data = any, Variables = object>\n  extends UseQueryState<Data, Variables> {\n  executeQuery: (opts?: Partial<OperationContext>) => void;\n}\n\nexport function Query<Data = any, Variables = any>(\n  props: QueryProps<Data, Variables>\n): ReactElement<any> {\n  const query = useQuery<Data, Variables>(props);\n  return props.children({ ...query[0], executeQuery: query[1] });\n}\n","import { ReactElement } from 'react';\nimport { OperationContext } from '@urql/core';\n\nimport {\n  useSubscription,\n  UseSubscriptionArgs,\n  UseSubscriptionState,\n  SubscriptionHandler,\n} from '../hooks';\n\nexport interface SubscriptionProps<\n  Data = any,\n  Result = Data,\n  Variables = object\n> extends UseSubscriptionArgs<Variables, Data> {\n  handler?: SubscriptionHandler<Data, Result>;\n  children: (arg: SubscriptionState<Result, Variables>) => ReactElement<any>;\n}\n\nexport interface SubscriptionState<Data = any, Variables = object>\n  extends UseSubscriptionState<Data, Variables> {\n  executeSubscription: (opts?: Partial<OperationContext>) => void;\n}\n\nexport function Subscription<Data = any, Result = Data, Variables = object>(\n  props: SubscriptionProps<Data, Result, Variables>\n): ReactElement<any> {\n  const subscription = useSubscription<Data, Result, Variables>(\n    props,\n    props.handler\n  );\n\n  return props.children({\n    ...subscription[0],\n    executeSubscription: subscription[1],\n  });\n}\n"],"names":["const","defaultClient","createClient","url","Context","createContext","Provider","Consumer","displayName","let","hasWarnedAboutDefault","useClient","client","useContext","process","env","NODE_ENV","initialState","fetching","stale","error","undefined","data","extensions","operation","isShallowDifferent","a","b","x","computeNextState","prevState","result","newState","hasDepsChanged","i","l","length","useMutation","query","isMounted","useRef","setState","current","state","executeMutation","useRequest","variables","prev","key","request","getCacheForClient","_react","reclaim","Set","map","Map","operations$","kind","has","delete","get","set","value","dispose","add","isSuspense","context","suspense","useQuery","args","cache","source","useMemo","executeQuery","pause","requestPolicy","resolve","promise","Promise","_resolve","deps","ref","currentResult","getSnapshot","updateResult","nextResult","subscribe","hasResult","useCallback","opts","onPush","useSubscription","handler","handlerRef","executeSubscription","useState","Mutation","props","children","mutation","Query","Subscription","subscription"],"mappings":";;;;;;AAIA;;AACAA,IAAAC,aAAA,GAAAC,iBAAA,CAAA;AAAAC,EAAAA,GAAA,EAAA,UAAA;AAAA,CAAA,CAAAH,CAAAA;IAEAI,OAAA,GAAAC,mBAAA,CAAAJ,aAAA,EAAAD;AACAM,IAAAA,QAAA,GAAAF,OAAA,CAAAE,SAAAN;AACAO,IAAAA,QAAA,GAAAH,OAAA,CAAAG,SAAAP;AACAI,OAAA,CAAAI,WAAA,GAAA,aAAA,CAAA;AAEAC,IAAAC,qBAAA,GAAA,KAAAD,CAAAA;AAEAE,SAAAA,YAAA;AACEX,EAAAA,IAAAY,MAAA,GAAAC,gBAAA,CAAAT,OAAA,CAAAJ,CAAAA;;AAEA,EAAA,IAAAc,OAAA,CAAAC,GAAA,CAAAC,QAAA,KAAA,YAAA,IAEEJ,MAAA,KAAAX,aAFF,IAGE,CAAAS,qBAHF,EAGE;;mMAQI;AAEL,GAAA;;AAED,EAAA,OAAAE,MAAA,CAAA;AACF;;;;;;;;;;;;;;;;;;;;ACjCAZ,IAAAiB,YAAA,GAAA;AACEC,EAAAA,QAAA,EAAA,KADF;AAEEC,EAAAA,KAAA,EAAA,KAFF;AAGEC,EAAAA,KAAA,EAAAC,SAHF;AAIEC,EAAAA,IAAA,EAAAD,SAJF;AAKEE,EAAAA,UAAA,EAAAF,SALF;AAMEG,EAAAA,SAAA,EAAAH,SAAAA;AANF,CAAArB,CAAAA;;AASAyB,SAAAA,mBAAAC,GAAAC,GAAA;;;;;mBAEqB;AAAA,IAAA,IAAA,EAAAC,CAAA,IAAAD,CAAA,CAAA,EAAe;AAAA,MAAA,OAAA,IAAA,CAAA;AAAA,KAAA;AAAA,GAAA;;;2BACI;AAAA,MAAA,OAAA,IAAA,CAAA;AAAA,KAAA;AAAA,GAAA;;AACtC,EAAA,OAAA,KAAA,CAAA;AACF,CAAA;;AASAE,SAAAA,iBAAAC,WAAAC,QAAA;AAIE/B,EAAAgC,IAAAA,QAAA,GAAA,WAAA,EACEF,SADF,EAEEC,MAFF;;AAKEb,IAAAA,QAAA,EAAA,CAAA,CAAAa,MAAA,CAAAb;AACAC,IAAAA,KAAA,EAAA,CAAA,CAAAY,MAAA,CAAAZ,KAAAA;GANF,CAAAnB,CAAAA;;AASA,EAAAyB,OAAAA,kBAAA,CAAAK,SAAA,EAAAE,QAAA,CAAA,GAAAA,QAAA,GAAAF,SAAA,CAAA;AACF,CAAA;AAEAG,SAAAA,eAAAP,GAAAC,GAAA;AACE,EAAA,KAAAlB,IAAAyB,CAAA,GAAA,CAAAzB,EAAA0B,CAAA,GAAAR,CAAA,CAAAS,MAAA,EAAAF,CAAA,GAAAC,CAAA,EAAAD,CAAA,EAAA;uBAA6D;AAAA,MAAA,OAAA,IAAA,CAAA;AAAA,KAAA;AAAA,GAAA;;AAC7D,EAAA,OAAA,KAAA,CAAA;AACF;;ACTA,SAAAG,WAAA,CAAAC,KAAA,EAAA;AAGEtC,EAAAA,IAAAuC,SAAA,GAAAC,YAAA,CAAA,IAAA,CAAAxC,CAAAA;AACAA,EAAAY,IAAAA,MAAA,GAAAD,SAAA,EAAAX,CAAAA;;;;;;;;;;AAkBQyC,QAAAA,QAAA,CAAA;AACEvB,UAAAA,QAAA,EAAA,KADF;AAEEC,UAAAA,KAAA,EAAA,CAAA,CAAAY,MAAA,CAAAZ,KAFF;2BAAA;6BAAA;uCAAA;;AAAA,SAAA,CAAA,CAAA;AAQD,OAAA;;AACD,MAAA,OAAAY,MAAA,CAAA;AACF;;AAGF,EAAA,CAAAnB,MAAA,EAAA0B,KAAA,EAAAG,QAAA;;AAIAF,IAAAA,SAAA,CAAAG,OAAA,GAAA,IAAA,CAAA;AACA,IAAA,mBAAA;AACEH,MAAAA,SAAA,CAAAG,OAAA,GAAA,KAAA,CAAA;AACF,KAFA,CAAA;;AAKF,EAAA,OAAA,CAAAC,KAAA,EAAAC,eAAA,CAAA,CAAA;AACF;;AC3EA;;AACA,SAAAC,UAAA,CAAAP,KAAA,EAAAQ,SAAA,EAAA;AAIE9C,EAAAA,IAAA+C,IAAA,GAAAP,YAAA,CAAAnB,SAAA,CAAArB,CAAAA;;;;AAKE,IAAA,IAAA+C,IAAA,CAAAL,OAAA,KAAArB,SAAA,IAAA0B,IAAA,CAAAL,OAAA,CAAAM,GAAA,KAAAC,OAAA,CAAAD,GAAA,EAAA;;AAEC,KAFD,MAEO;AACLD,MAAAA,IAAA,CAAAL,OAAA,GAAAO,OAAA,CAAA;AACA,MAAA,OAAAA,OAAA,CAAA;AACD,KAAA;AACH,KAAA,CAAAX,KAAA,EAAAQ,SAAA;AACF;;SCNAI,kBAAAtC,QAAA;AACE,EAAA,IAAA,CAAAA,MAAA,CAAAuC,MAAA,EAAA;AACEnD,IAAAA,IAAAoD,OAAA,GAAA,IAAAC,GAAA,EAAArD,CAAAA;AACAA,IAAAA,IAAAsD,GAAA,GAAA,IAAAC,GAAA,EAAAvD,CAAAA;;AAEA,IAAA,IAAAY,MAAA,CAAA4C,WAAAA;AAAA;AAAA,MAAA;;AAIM,UAAA,IAAAhC,SAAA,CAAAiC,IAAA,KAAA,UAAA,IAAAL,OAAA,CAAAM,GAAA,CAAAlC,SAAA,CAAAwB,GAAA,CAAA,EAAA;AACEI,YAAAA,OAAA,CAAAO,MAAA,CAAAnC,SAAA,CAAAwB,GAAA,CAAA,CAAA;AACAM,YAAAA,GAAA,CAAAK,MAAA,CAAAnC,SAAA,CAAAwB,GAAA,CAAA,CAAA;AACD,WAAA;;AAGN,OAAA;;;AAGCY,MAAAA,GAAA,EAAA,SAAAA,GAAA,CAAAZ,GAAA,EAAA;AACE,QAAA,OAAAM,GAAA,CAAAM,GAAA,CAAAZ,GAAA,CAAA,CAAA;;;AAGAI,QAAAA,OAAA,CAAAO,MAAA,CAAAX,GAAA,CAAA,CAAA;AACAM,QAAAA,GAAA,CAAAO,GAAA,CAAAb,GAAA,EAAAc,KAAA,CAAA,CAAA;;AAEFC,MAAAA,OAAA,EAAA,SAAAA,OAAA,CAAAf,GAAA,EAAA;AACEI,QAAAA,OAAA,CAAAY,GAAA,CAAAhB,GAAA,CAAA,CAAA;;;AAGL,GAAA;;;AAGH;;ACJAiB,SAAAA,WAAArD,QAAAsD,SAAA;AAAA,EAAA,OAAAtD,MAAA,CAAAuD,QAAA,KAAA,CAAAD,OAAA,IAAAA,OAAA,CAAAC,QAAA,KAAA,KAAA,CAAA,CAAA;AAAA,CAAA;;AAGA,SAAAC,QAAA,CAAAC,IAAA,EAAA;AAGErE,EAAAY,IAAAA,MAAA,GAAAD,SAAA,EAAAX,CAAAA;AACAA,EAAAA,IAAAsE,KAAA,GAAApB,iBAAA,CAAAtC,MAAA,CAAAZ,CAAAA;;AAEAA,EAAAiD,IAAAA,OAAA,GAAAJ,UAAA,CAAAwB,IAAA,CAAA/B,KAAA,EAAA+B,IAAA,CAAAvB,SAAA,CAAA9C,CAAAA;AAEAA,EAAAA,IAAAuE,MAAA,GAAAC,aAAA,aAAA;oBACkB;AAAA,MAAA,OAAA,IAAA,CAAA;AAAA,KAAA;;AAEhBxE,IAAAuE,IAAAA,MAAA,GAAA3D,MAAA,CAAA6D,YAAA,CAAAxB,OAAA,EAAA,WAAA;;KAAA,cAAA,CAAA,CAAAjD,CAAAA;AAKA,IAAA,OAAAmE,QAAA;;AAKM,MALN,OAAA,CAAA,SAAA,CAAA;AAQF,GAhBA,EAgBA,MAAA,QAAA,SAAA,UAAA,EAKEE,IAAA,CAAAK,KALF,EAMEL,IAAA,CAAAM,aANF,EAOEN,IAAA,CAAAH,OAPF,CAhBA,CAAAlE,CAAAA;;AA+BI,IAAA,IAAA,CAAAuE,MAAA,EAAa;AAAA,MAAA,OAAA;AAAArD,QAAAA,QAAA,EAAA,KAAA;AAAA,OAAA,CAAA;AAAA,KAAA;;;;;AAIXT,MAAAA,IAAAmE,OAAAnE,CAAAA;;;;AAOI,QAAA,IAAAmE,OAAA;;;;;;;AAIJ,MAAA,IAAA7C,MAAA,IAAA,IAAA,IAAAoC,QAAA,EAAA;AACEnE,QAAAA,IAAA6E,OAAA,GAAA,IAAAC,OAAA,CAAA,UAAAC,QAAA,EAAA;;AAEA,SAFA,CAAA/E,CAAAA;;AAKA,QAAA,MAAA6E,OAAA,CAAA;AACD,OAPD,MAOO;;AAEN,OAAA;AACF;AACC,MAAA,MAAA9C,MAAA,CAAA;AACD,KAAA;;AAED,IAAA,OAAAA,MAAA,IAAA;AAAAb,MAAAA,QAAA,EAAA,IAAA;AAAA,KAAA,CAAA;AACF,KAAA,CAAAoD,KAAA,EAAArB,OAAA;AAIFjD,EAAAA,IAAAgF,IAAA,GAAA,OAAA,SAAA,EAGEX,IAAA,CAAAM,aAHF,EAIEN,IAAA,CAAAH,OAJF,EAKEG,IAAA,CAAAK,KALF,CAAA1E,CAAAA;;;AAcc;;MAAAyC,QAAA,GAAAwC,GAAA,CAAA,CAAA;AAGdxE,EAAAA,IAAAyE,aAAA,GAAAvC,KAAA,CAAA,CAAA,CAAAlC,CAAAA;;AACA,EAAA,IAAA8D,MAAA,KAAA5B,KAAA,CAAA,CAAA,CAAA,IAAAV,cAAA,CAAAU,KAAA,CAAA,CAAA,CAAA,EAAAqC,IAAA,CAAA,EAAA;AACEvC,IAAAA,QAAA,CAAA,OAAA,EAEEyC,aAAA,GAAArD,gBAAA,CAAAc,KAAA,CAAA,CAAA,CAAA,EAAAwC,WAAA,CAAAZ,MAAA,EAAAJ,QAAA,CAAA,CAFF,MAAA,CAAA,CAAA,CAAA;AAQD,GAAA;;;AAGCnE,IAAAA,IAAAuE,MAAA,GAAA5B,KAAA,CAAA,CAAA,CAAA3C,CAAAA;;;;IAKAoF,SAAAA,aAAArD,QAAA;;;;AAII,QAAAY,OAAAA,KAAA,CAAA,CAAA,CAAA,KAAA0C,UAAA,GACE,CAAA1C,KAAA,CAAA,CAAA,CAAA,EAAA0C,UAAA,EAAA1C,KAAA,CAAA,CAAA,CAAA,CADF,QAAA,CAAA;AAGF;AACF,KAAA;;AAEA,IAAA,IAAA4B,MAAA,EAAA;yBAKIe,eAAA,CAAAF,YAAA;AADEA,QAAAA,YAAA,CAAA;AAAAlE,UAAAA,QAAA,EAAA,KAAA;AAAA,SAAA,CAAA,CAAA;AACF;;AAIF,MAAA,IAAA,CAAAqE,SAAA,EAAgB;AAAAH,QAAAA,YAAA,CAAA;AAAAlE,UAAAA,QAAA,EAAA,IAAA;AAAA,SAAA,CAAA,CAAA;AAAA,OAAA;;AAEhB,MAAA,mBAAA;AACEoD,QAAAA,KAAA,CAAAP,OAAA,CAAAd,OAAA,CAAAD,GAAA,CAAA,CAAA;;AAEF,OAHA,CAAA;AAID,KAfD,MAeO;AACLoC,MAAAA,YAAA,CAAA;AAAAlE,QAAAA,QAAA,EAAA,KAAA;AAAA,OAAA,CAAA,CAAA;AACD,KAAA;AACH,KAAA,CAAAoD,KAAA,EAAA3B,KAAA,CAAA,CAAA,CAAA,EAAAA,KAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;AAEA3C,EAAAA,IAAAyE,YAAA,GAAAe,iBAAA,CAAA,UAAAC,IAAA,EAAA;AAEIzF,IAAAA,IAAAkE,OAAA,GAAA,WAAA;;KAAA,cAAA,EAGEuB,IAHF,CAAAzF,CAAAA;;;8BAQI0F,YAAA,CAAA,UAAA3D,MAAA,EAAA;;AAII,OAJJ,EAAAnB,MAAA,CAAA6D,YAAA,CAAAxB,OAAA,EAAAiB,OAAA;;AAQJ;AACF,GAnBF,EAmBE,OAAA,OAAA,SAAA,UAAA,aAAA,EAOEG,IAAA,CAAAM,aAPF,EAQEN,IAAA,CAAAH,OARF,CAnBF,CAAAlE,CAAAA;AA+BA,EAAA,OAAA,CAAAkF,aAAA,EAAAT,YAAA,CAAA,CAAA;AACF;;AChLA,SAAAkB,eAAA,CAAAtB,IAAA,EAAAuB,OAAA,EAAA;AAIE5F,EAAAY,IAAAA,MAAA,GAAAD,SAAA,EAAAX,CAAAA;AACAA,EAAAiD,IAAAA,OAAA,GAAAJ,UAAA,CAAAwB,IAAA,CAAA/B,KAAA,EAAA+B,IAAA,CAAAvB,SAAA,CAAA9C,CAAAA;AAEAA,EAAAA,IAAA6F,UAAA,GAAArD,YAAA,CAAAoD,OAAA,CAAA5F,CAAAA;AAGA6F,EAAAA,UAAA,CAAAnD,OAAA,GAAAkD,OAAA,CAAA;AAEA5F,EAAAA,IAAAuE,MAAA,GAAAC,aAAA,aAAA;AAAA,IAAA,OAAA,CAAAH,IAAA,CAAAK,KAAA,GAAA9D,MAAA,CAAAkF,mBAAA,CAAA7C,OAAA,EAAAoB,IAAA,CAAAH,OAAA,CAAA,GAAA,IAAA,CAAA;AAAA,GAAA,EAAA,CAAAtD,MAAA,EAAAqC,OAAA,EAAAoB,IAAA,CAAAK,KAAA,EAAAL,IAAA,CAAAH,OAAA,CAAA,CAAAlE,CAAAA;AAMAA,EAAAA,IAAAgF,IAAA,GAAA,CAAApE,MAAA,EAAAqC,OAAA,EAAAoB,IAAA,CAAAH,OAAA,EAAAG,IAAA,CAAAK,KAAA,CAAA1E,CAAAA;AAEA,EAAA,IAAAiF,GAAA,GAAAc,cAAA,CAAA;WAAA,CAAAxB,MAAA,EAAA,SAAA,EAAA,EAAAtD,YAAA,EAAA;AAAAC,MAAAA,QAAA,EAAA,CAAA,CAAAqD,MAAAA;AAAA,KAAA,CAAA,EAAAS,IAAA;AAAA,GAAA,CAAA,CAAA;AAAA,EAAA,IAAArC,KAAA,GAAAsC,GAAA,CAAA,CAAA,CAAA,CAAA;AAAA,EAAA,IAAAxC,QAAA,GAAAwC,GAAA,CAAA,CAAA,CAAA,CAAA;AAIAxE,EAAAA,IAAAyE,aAAA,GAAAvC,KAAA,CAAA,CAAA,CAAAlC,CAAAA;;AACA,EAAA,IAAA8D,MAAA,KAAA5B,KAAA,CAAA,CAAA,CAAA,IAAAV,cAAA,CAAAU,KAAA,CAAA,CAAA,CAAA,EAAAqC,IAAA,CAAA,EAAA;AACEvC,IAAAA,QAAA,CAAA,OAAA,EAEEyC,aAAA,GAAArD,gBAAA,CAAAc,KAAA,CAAA,CAAA,CAAA,EAAA;AAAAzB,MAAAA,QAAA,EAAA,CAAA,CAAAqD,MAAAA;AAAA,KAAA,CAFF,MAAA,CAAA,CAAA,CAAA;AAKD,GAAA;;;IAGCa,SAAAA,aAAArD,QAAA;;;;AAKI,QAAA,IAAAY,KAAA,CAAA,CAAA,CAAA,KAAA0C,UAAA,EAA6B;AAAA,UAAA,OAAA1C,KAAA,CAAA;AAAA,SAAA;;AAC7B,QAAA,IAAAkD,UAAA,CAAAnD,OAAA,IAAAC,KAAA,CAAA,CAAA,CAAA,CAAArB,IAAA,KAAA+D,UAAA,CAAA/D,IAAA,EAAA;AACE+D,UAAAA,UAAA,CAAA/D,IAAA,GAAAuE,UAAA,CAAAnD,OAAA,CAAAC,KAAA,CAAA,CAAA,CAAA,CAAArB,IAAA,EAAA+D,UAAA,CAAA/D,IAAA,CAAA,CAAA;AAID,SAAA;;AAED,QAAA,OAAA,CAAAqB,KAAA,CAAA,CAAA,CAAA,EAAA0C,UAAA,EAAA1C,KAAA,CAAA,CAAA,CAAA,CAAA,CAAA;AACF;AACF,KAAA;;AAEA,IAAA,IAAAA,KAAA,CAAA,CAAA,CAAA,EAAA;;AAIMyC,QAAAA,YAAA,CAAA;AAAAlE,UAAAA,QAAA,EAAA,KAAA;AAAA,SAAA,CAAA,CAAA;;AAIL,KARD,MAQO;AACLkE,MAAAA,YAAA,CAAA;AAAAlE,QAAAA,QAAA,EAAA,KAAA;AAAA,OAAA,CAAA,CAAA;AACD,KAAA;iBA7DL;;AAiEElB,EAAAA,IAAA8F,mBAAA,GAAAN,iBAAA,CAAA,UAAAC,IAAA,EAAA;AAEIzF,IAAAA,IAAAuE,MAAA,GAAA3D,MAAA,CAAAkF,mBAAA,CAAA7C,OAAA,EAAA,WAAA,cAAA,EAEEwC,IAFF,CAAA,CAAAzF,CAAAA;AAKAyC,IAAAA,QAAA,CAAA,UAAAE,KAAA,EAAA;AAAA,MAAA,OAAA,CAAA4B,MAAA,EAAA5B,KAAA,CAAA,CAAA,CAAA,EAAAqC,IAAA,CAAA,CAAA;AAAA,KAAA,CAAA,CAAA;GAPJ,iCAAA,CAAAhF,CAAAA;AAYA,EAAA,OAAA,CAAAkF,aAAA,EAAAY,mBAAA,CAAA,CAAA;AACF;;AChGA,SAAAE,QAAA,CAAAC,KAAA,EAAA;;AAIE,EAAAA,OAAAA,KAAA,CAAAC,QAAA,CAAA,QAAA,CAAA,EAAA,EAAAC,QAAA,CAAA,CAAA,CAAA,EAAA;AAAAvD,IAAAA,eAAA,EAAAuD,QAAA,CAAA,CAAA,CAAA;AAAA,GAAA,CAAA,CAAA,CAAA;AACF;;ACbA,SAAAC,KAAA,CAAAH,KAAA,EAAA;AAGEjG,EAAAA,IAAAsC,KAAA,GAAA8B,QAAA,CAAA6B,KAAA,CAAAjG,CAAAA;AACA,EAAAiG,OAAAA,KAAA,CAAAC,QAAA,CAAA,QAAA,CAAA,EAAA,EAAA5D,KAAA,CAAA,CAAA,CAAA,EAAA;AAAAmC,IAAAA,YAAA,EAAAnC,KAAA,CAAA,CAAA,CAAA;AAAA,GAAA,CAAA,CAAA,CAAA;AACF;;ACKA,SAAA+D,YAAA,CAAAJ,KAAA,EAAA;;sDAUI;AAAAH,IAAAA,mBAAA,EAAAQ,YAAA,CAAA,CAAA,CAAA;AAAA;AAEJ;;;;;;;;;;;;;;;;;;;"}